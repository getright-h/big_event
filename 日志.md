### 1.注册和登录的ajax

1. 使用jq的ajaxPrefilter来提前配置url地址，再进行拼接
2. 登陆成功后用localStorage记录token





### 2.渲染用户信息

1. 验证用户登录信息

   发送ajax信息，包含token的请求头 headers

2. 渲染头像

3. 把需要验证的请求头放入ajaxprefilter中

4. 退出功能

   清除token并跳转到登录页面

5. 解决不登录强制进入index页面问题

   jq的complete不管是否请求成功都会执行，在其中判断过滤

   在 complete 回调函数中，可以使用 res.responseJSON 拿到服务器响应回来的数据

6. 把complete验证放入ajaxprefilter中



### 3.设置并更新用户信息

1. 初始化用户信息，提取服务器返回数据并赋值给表单显示

2. 重置按钮，再次请求服务器返回的信息，复写表单

3. 要一起提交id信息，把id的input，hidden

4. 更新用户信息，发送填写好的表单，调用父级页面重新渲染信息的方法

   window.parent指向内联框架的父级页面



### 4.重置密码

1. 校验规则

2. ajax发送后重置表单

   reset()方法时原生的，要把jq对象换成dom对象

   [0]



### 5.更换头像

1. cropper插件

2. 隐藏file框

3. 上传图片到裁剪区

   1. 监听change事件，e.target.files[0]可以获取图片
   2. URL.createObjectURL(e.target.files[0])可以把图片化为路径

4. 上传到服务器，重新渲染

   将裁剪后的图片，输出为 base64 格式的字符串

    window.parent.getUserInfo();






### 6.绘制文章类别页面

1. template模板引擎绘制表单

2. 模板引擎编写弹框内容

3. 提交文章分类信息时，因为时模板引擎动态添加，所以要用事件代理来绑定

4. 存储弹窗的索引，之后根据索引，关闭对应的弹出层

5. 编辑按钮同样的使用模板引擎，事件代理

6. 在遍历填充表单信息的文本框中，添加h5自定义属性

   在点击编辑按钮时发送当前按钮的id，根据id获取当前点击对象一栏的信息

   然后form.val()填入弹窗中

7. 编辑按钮提交

8. 删除按钮按照以上步骤重复即可





### 7.绘制文章分页页面

1. 定义查询参数q

2. 发送q，把数据放入模板引擎

3. 定义美化时间的过滤器

4. 绘制筛选区域ui

5. 发起请求获取并渲染文章分类的下拉选择框

   因为是ajax异步载入数据，layuijs没有监听到此项操作。

   使用form.render()解决

6. 筛选功能，获取页面信息，复写q的对应值，然后重新渲染

7. 获取文章总数，渲染分页，通过layer.render()渲染基本分页结构

8. 页码发生改变时，触发jump回调，获取到最新页码，并更新到q.pagenum

9. 调用layerpage时会自动触发jump回调，造成死循环，判断

   触发jump回调的方式有2：

   ​                1.点击页码，first值为undefined

   ​                2.调用layerpage.render()，firser

10. 自定义分页选项



### 8.删除文章按钮

1. 获取自定义属性中绑定的id，删除对应的文章
2. 当前页数据删除后，应该判断是否还有数据
3. 没有的话就让页数-1，再刷新





### 9.绘制发布文章页面

1. 发送文章类别的请求，用模板引擎渲染，再form.render()

2. 引入插件，富文本，照片裁剪

3. 通过formdata快速序列化表单

   ```
   <form id="advForm">
       <p>广告名称：<input type="text" name="advName"  value="xixi"></p>
       <p>广告类别：<select name="advType">
           <option value="1">轮播图</option>
           <option value="2">轮播图底部广告</option>
           <option value="3">热门回收广告</option>
           <option value="4">优品精选广告</option>
       </select></p>
       <p><input type="button" id="btn" value="添加"></p>
   </form>
   
   //获得表单按钮元素
   var btn=document.querySelector("#btn");
   //为按钮添加点击事件
   btn.onclick=function(){
       //根据ID获得页面当中的form表单元素
       var form=document.querySelector("#advForm");
       //将获得的表单元素作为参数，对formData进行初始化
       var formdata=new FormData(form);
       //通过get方法获得name为advName元素的value值
       console.log(formdata.get("advName"));//xixi
       //通过get方法获得name为advType元素的value值
       console.log(formdata.get("advType"));//1 
   }
   ```

   操作方法：

   ```
   、通过get(key)与getAll(key)来获取相对应的值
   通过append(key,value)在数据末尾追加数据
   set(key,value)修改数据
   has(key)判断对应key是否存在
   delete(key)
   
   ```

   